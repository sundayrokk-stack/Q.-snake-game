<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Snake Pro - Levels & Speed</title>
    <style>
        :root {
            --neon-green: #39FF14;
            --neon-red: #FF3131;
            --neon-blue: #00f3ff;
            --bg-color: #0a0a0a;
        }

        body {
            background-color: var(--bg-color);
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            overflow: hidden;
            touch-action: manipulation;
        }

        #ui-top {
            display: flex;
            gap: 20px;
            margin: 10px 0;
            font-weight: bold;
        }

        .stat-box { color: var(--neon-green); border: 1px solid #333; padding: 5px 15px; border-radius: 5px; }

        #game-container { position: relative; }

        canvas {
            border: 4px solid #333;
            background-color: black;
            display: block;
        }

        /* Overlays */
        .overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
        }

        .menu-card {
            background: #1a1a1a;
            padding: 20px;
            border: 2px solid var(--neon-blue);
            border-radius: 10px;
            text-align: center;
        }

        button {
            padding: 10px 25px;
            margin: 5px;
            background: transparent;
            color: white;
            border: 2px solid var(--neon-green);
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }

        button:hover { background: var(--neon-green); color: black; }
        button.active { background: var(--neon-blue); border-color: var(--neon-blue); color: black; }

        /* Controls */
        #controls {
            display: grid;
            grid-template-areas: ". up pause" "left down right";
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            width: 55px;
            height: 55px;
            background: #222;
            border: 2px solid var(--neon-green);
            color: var(--neon-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        #pause-btn { grid-area: pause; border-color: var(--neon-blue); color: var(--neon-blue); }
    </style>
</head>
<body>

    <div id="ui-top">
        <div class="stat-box">LVL: <span id="lvl-display">1</span></div>
        <div class="stat-box">SCORE: <span id="score-display">0</span></div>
    </div>

    <div id="game-container">
        <canvas id="gameCanvas" width="400" height="400"></canvas>

        <div id="menu-overlay" class="overlay">
            <div class="menu-card">
                <h1 style="color: var(--neon-blue);">NEON SNAKE</h1>
                <p>Select Difficulty:</p>
                <button onclick="setBaseSpeed(150, this)" class="active">SLOW</button>
                <button onclick="setBaseSpeed(80, this)">FAST</button>
                <br><br>
                <button onclick="startGame()" style="width: 100%; background: var(--neon-green); color: black;">START GAME</button>
            </div>
        </div>

        <div id="status-overlay" class="overlay" style="display: none;">
            <h1 id="status-text" style="color: var(--neon-red);">PAUSED</h1>
            <button onclick="togglePause()">RESUME</button>
            <button onclick="location.reload()">MAIN MENU</button>
        </div>
    </div>

    <div id="controls">
        <div class="btn" id="up" style="grid-area: up;" onclick="changeDirection('up')">▲</div>
        <div class="btn" id="left" style="grid-area: left;" onclick="changeDirection('left')">◀</div>
        <div class="btn" id="down" style="grid-area: down;" onclick="changeDirection('down')">▼</div>
        <div class="btn" id="right" style="grid-area: right;" onclick="changeDirection('right')">▶</div>
        <div class="btn" id="pause-btn" onclick="togglePause()">II</div>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const gridSize = 20;
        const tileCount = canvas.width / gridSize;

        let snake, food, dx, dy, score, level, isPaused, baseSpeed, gameTimeout;

        function init() {
            snake = [{x: 10, y: 10}];
            dx = 0; dy = 0;
            score = 0;
            level = 1;
            isPaused = false;
            baseSpeed = 150; // Default slow
            updateUI();
        }

        function setBaseSpeed(speed, btn) {
            baseSpeed = speed;
            document.querySelectorAll('.menu-card button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function startGame() {
            document.getElementById('menu-overlay').style.display = 'none';
            createFood();
            gameLoop();
        }

        function togglePause() {
            if (document.getElementById('status-overlay').style.display === 'flex' && 
                document.getElementById('status-text').innerText === 'GAME OVER') return;
            
            isPaused = !isPaused;
            document.getElementById('status-overlay').style.display = isPaused ? 'flex' : 'none';
            document.getElementById('status-text').innerText = 'PAUSED';
            document.getElementById('status-text').style.color = 'var(--neon-blue)';
            if (!isPaused) gameLoop();
        }

        function updateUI() {
            document.getElementById('score-display').innerText = score;
            document.getElementById('lvl-display').innerText = level;
        }

        function gameLoop() {
            if (isPaused) return;

            if (checkGameOver()) {
                showGameOver();
                return;
            }

            // Level Logic: Advance level every 50 points, max 25
            level = Math.min(25, Math.floor(score / 50) + 1);
            updateUI();

            // Speed Logic: Higher level = shorter delay (faster)
            // Minimum delay cap at 30ms to keep it playable
            let currentSpeed = Math.max(30, baseSpeed - (level * 4));

            gameTimeout = setTimeout(() => {
                clearCanvas();
                drawFood();
                moveSnake();
                drawSnake();
                gameLoop();
            }, currentSpeed);
        }

        function clearCanvas() {
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function drawSnake() {
            ctx.fillStyle = "#39FF14";
            snake.forEach((part, index) => {
                // Head is slightly brighter
                ctx.globalAlpha = index === 0 ? 1 : 0.8;
                ctx.fillRect(part.x * gridSize, part.y * gridSize, gridSize - 2, gridSize - 2);
            });
            ctx.globalAlpha = 1;
        }

        function moveSnake() {
            if (dx === 0 && dy === 0) return;
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head);

            if (head.x === food.x && head.y === food.y) {
                score += 10;
                createFood();
            } else {
                snake.pop();
            }
        }

        function checkGameOver() {
            if (dx === 0 && dy === 0) return false;
            const head = snake[0];
            const hitWall = head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount;
            let hitSelf = false;
            for (let i = 1; i < snake.length; i++) {
                if (snake[i].x === head.x && snake[i].y === head.y) hitSelf = true;
            }
            return hitWall || hitSelf;
        }

        function showGameOver() {
            const overlay = document.getElementById('status-overlay');
            const text = document.getElementById('status-text');
            text.innerText = 'GAME OVER';
            text.style.color = 'var(--neon-red)';
            overlay.style.display = 'flex';
        }

        function drawFood() {
            ctx.fillStyle = "var(--neon-red)";
            ctx.shadowBlur = 10;
            ctx.shadowColor = "red";
            ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);
            ctx.shadowBlur = 0;
        }

        function createFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
        }

        function changeDirection(dir) {
            if (isPaused) return;
            if (dir === 'up' && dy === 0) { dx = 0; dy = -1; }
            if (dir === 'down' && dy === 0) { dx = 0; dy = 1; }
            if (dir === 'left' && dx === 0) { dx = -1; dy = 0; }
            if (dir === 'right' && dx === 0) { dx = 1; dy = 0; }
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === "ArrowUp") changeDirection('up');
            if (e.key === "ArrowDown") changeDirection('down');
            if (e.key === "ArrowLeft") changeDirection('left');
            if (e.key === "ArrowRight") changeDirection('right');
            if (e.key.toLowerCase() === "p") togglePause();
        });

        init();
    </script>
</body>
</html>
